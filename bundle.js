(()=>{"use strict";class e{constructor(e,t,s,r){this._title=e,this._image=t,this._hendelClickCard=r,this._templateSelector=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardLike=this._element.querySelector(".card__like"),this._setEventListeners(),this._element.querySelector(".card__title").textContent=this._title,this._cardImage.src=this._image,this._cardImage.alt=this._title,this._element}_setEventListeners(){this._element.querySelector(".card__remove-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardLike.addEventListener("click",(()=>{this._handleLikeCard()})),this._cardImage.addEventListener("click",(()=>{this._hendelClickCard(this._title,this._image)}))}_handleDeleteCard(){this._element.remove(),this._element=null}_handleLikeCard(){this._cardLike.classList.toggle("card__like_checked")}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formSelector=t,this._inputList=Array.from(this._formSelector.querySelectorAll(this._inputSelector)),this._button=this._formSelector.querySelector(this._submitButtonSelector)}enableValidation(){this._setEvenListeners()}_checkInputValidity(e){e.validity.valid?this._showInputError(e):this._hideInputError(e)}_showInputError(e){this._formSelector.querySelector(`.${e.name}-error`).textContent="",e.classList.remove(this._inputErrorClass)}_hideInputError(e){this._formSelector.querySelector(`.${e.name}-error`).textContent=e.validationMessage,e.classList.add(this._inputErrorClass)}_toggleButton(e,t){e.every((e=>e.validity.valid))?(t.classList.remove(this._inactiveButtonClass),t.disabled=""):this.disableButton()}_setEvenListeners(){this._toggleButton(this._inputList,this._button),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton(this._inputList,this._button)}))}))}disableButton(){this._button.classList.add(this._inactiveButtonClass),this._button.setAttribute("disabled","disabled")}}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_open")&&this.close()})),this._popup.querySelector(".popup__close").addEventListener("click",(()=>{this.close()}))}}class r extends s{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}open(){super.open()}close(){super.close(),this._form.reset()}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues())}))}}const n={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},i=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),a=document.querySelector(".popup__form_add"),l=document.querySelector(".popup__form_profile"),p=new class{constructor(e,t){this._userName=document.querySelector(e),this._userJob=document.querySelector(t),this._inputName=document.querySelector(".popup__input_form_name"),this._inputJob=document.querySelector(".popup__input_form_job")}getUserInfo(){return{name:this._userName.textContent,job:this._userJob.textContent}}setUserInfo(e,t){this._userName.textContent=e,this._userJob.textContent=t}}(".profile__title",".profile__subtitle"),c=new class extends s{constructor(e){super(e),this._image=this._popup.querySelector(".popup__big-image"),this._name=this._popup.querySelector(".popup__image-caption")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._name.textContent=e}}(".popup_big-image");c.setEventListeners();const _=new t(n,a);_.enableValidation(),new t(n,l).enableValidation();const u=new r(".popup_edit-profile",(e=>{p.setUserInfo(e.name,e.job),u.close()}));i.addEventListener("click",(()=>{u.open(),u.setInputValues(p.getUserInfo())})),u.setEventListeners();const d=(e,t)=>{c.open(e,t)};function h(t){return new e(t.name,t.link,"#card",d).generateCard()}const m=new class{constructor({data:e,renderer:t},s){this._initialArray=e,this._renderer=t,this._container=document.querySelector(s)}renderer(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({data:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=h(e);m.addItem(t)}},".cards");m.renderer();const v=new r(".popup_new-card",(e=>{const t=h(e);console.log(t),m.addItem(t),_.disableButton(),v.close()}));o.addEventListener("click",(()=>v.open())),v.setEventListeners()})();